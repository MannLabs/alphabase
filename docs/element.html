---

title: Atom element information


keywords: fastai
sidebar: home_sidebar



nb_path: "nbdev_nbs/constants/element.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbdev_nbs/constants/element.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When we have the chemical element information, we define the max isotope abundance distribution length (<a href="/alphabase/element.html#MAX_ISOTOPE_LEN"><code>MAX_ISOTOPE_LEN</code></a>) for each element and combination of elements. If the isotope length is larger than <a href="/alphabase/element.html#MAX_ISOTOPE_LEN"><code>MAX_ISOTOPE_LEN</code></a>, we <code>truncate_isotope()</code> by keeping the monoisotope and its top <code>MAX_ISOTOPE_LEN-1</code> abundant neighbors.</p>
<p><a href="/alphabase/element.html#EMPTY_DIST"><code>EMPTY_DIST</code></a> defines a "zero element", its monoisotopic position is 0 with abundance 1. It is used for abundance convolution between different isotopes (see <code>abundance_convolution()</code>).</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="truncate_isotope" class="doc_header"><code>truncate_isotope</code><a href="https://github.com/MannLabs/alphabase/tree/main/alphabase/constants/element.py#L36" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>truncate_isotope</code>(<strong><code>isotopes</code></strong>:<code>array</code>, <strong><code>mono_idx</code></strong>:<code>int</code>)</p>
</blockquote>
<p>For a given isotope distribution (intensity patterns),
this function truncates the distribution by top
<a href="/alphabase/element.html#MAX_ISOTOPE_LEN"><code>MAX_ISOTOPE_LEN</code></a> neighbors those contain the monoisotopic
peak pointed by <code>mono_idx</code>.</p>
<p>Args:
    isotopes (np.array):
        Isotope patterns with size &gt; <a href="/alphabase/element.html#MAX_ISOTOPE_LEN"><code>MAX_ISOTOPE_LEN</code></a>.
    mono_idx (int):
        Monoisotopic peak position (index) in the isotope patterns</p>
<p>Returns:
    int: the new position of <code>mono_idx</code>
    int: the start position of the truncated isotopes
    int: the end position of the truncated isotopes</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Load-chemical-element-information">Load chemical element information<a class="anchor-link" href="#Load-chemical-element-information"> </a></h1><p>First, we load <code>alphadeep/constants/nist_element.yaml</code> into <a href="/alphabase/element.html#CHEM_INFO_DICT"><code>CHEM_INFO_DICT</code></a>, which is the base dict for further processing.</p>
<p>Then we call <code>reset_elements()</code> to extract corresponding information for <a href="/alphabase/element.html#CHEM_MONO_MASS"><code>CHEM_MONO_MASS</code></a> (mono mass dict), <a href="/alphabase/element.html#CHEM_ISOTOPE_DIST"><code>CHEM_ISOTOPE_DIST</code></a> (isotope distribution dict), and <a href="/alphabase/element.html#CHEM_MONO_IDX"><code>CHEM_MONO_IDX</code></a> (dict of mono position in the isotope distribution).</p>
<p>At last, <a href="/alphabase/element.html#MASS_H2O"><code>MASS_H2O</code></a> and <a href="/alphabase/element.html#MASS_NH3"><code>MASS_NH3</code></a> are re-calculated based on masses of <code>H</code>, <code>O</code>, and <code>N</code> in <a href="/alphabase/element.html#CHEM_MONO_MASS"><code>CHEM_MONO_MASS</code></a>.</p>
<p>All these steps are done in <code>load_elem_yaml(yaml_file)</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="reset_elements" class="doc_header"><code>reset_elements</code><a href="https://github.com/MannLabs/alphabase/tree/main/alphabase/constants/element.py#L94" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>reset_elements</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_elem_yaml" class="doc_header"><code>load_elem_yaml</code><a href="https://github.com/MannLabs/alphabase/tree/main/alphabase/constants/element.py#L126" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_elem_yaml</code>(<strong><code>yaml_file</code></strong>:<code>str</code>)</p>
</blockquote>
<p>Load built-in or user-defined element yaml file. Default yaml is:
os.path.join(_base_dir, 'nist_element.yaml')</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Calculate-mass-from-a-formula">Calculate mass from a formula<a class="anchor-link" href="#Calculate-mass-from-a-formula"> </a></h1><p>Now we have <a href="/alphabase/element.html#CHEM_MONO_MASS"><code>CHEM_MONO_MASS</code></a>, we can calculate the mass of different chemical formula. Formula format: <code>H(1)C(2)O(3)...</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="parse_formula" class="doc_header"><code>parse_formula</code><a href="https://github.com/MannLabs/alphabase/tree/main/alphabase/constants/element.py#L162" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>parse_formula</code>(<strong><code>formula</code></strong>:<code>str</code>)</p>
</blockquote>
<p>Given a formula (str, e.g. <code>H(1)C(2)O(3)</code>),
it generates <code>[('H', 2), ('C', 2), ('O', 1)]</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="calc_mass_from_formula" class="doc_header"><code>calc_mass_from_formula</code><a href="https://github.com/MannLabs/alphabase/tree/main/alphabase/constants/element.py#L176" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>calc_mass_from_formula</code>(<strong><code>formula</code></strong>:<code>str</code>)</p>
</blockquote>
<p>Calculates the mass of the formula`</p>
<p>Args:
    formula (str): e.g. <code>H(1)C(2)O(3)</code></p>
<p>Returns:
    float: mass of the formula</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Example</p>

</div>
</div>
</div>
</div>
 

