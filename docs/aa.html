---

title: Amino acid information


keywords: fastai
sidebar: home_sidebar



nb_path: "nbdev_nbs/constants/aa.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbdev_nbs/constants/aa.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We use all 128 ASCII code to represent amino acids for flexible extensions in the future.</p>
<p>The amino acid masses are stored in 128-lengh array <a href="/alphabase/aa.html#AA_ASCII_MASS"><code>AA_ASCII_MASS</code></a>. If an ASCII code is not in <a href="/alphabase/aa.html#AA_CHEM"><code>AA_CHEM</code></a>, the mass will be <code>1e8</code> to disable it for MS search.</p>
<p>We also provide a AA table (<a href="/alphabase/aa.html#AA_DF"><code>AA_DF</code></a> dataframe) for users.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="reset_AA_mass" class="doc_header"><code>reset_AA_mass</code><a href="https://github.com/MannLabs/alphabase/tree/main/alphabase/constants/aa.py#L32" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>reset_AA_mass</code>()</p>
</blockquote>
<p>AA mass in np.array with shape (128,)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="reset_AA_df" class="doc_header"><code>reset_AA_df</code><a href="https://github.com/MannLabs/alphabase/tree/main/alphabase/constants/aa.py#L42" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>reset_AA_df</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">AA_DF</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">):</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">),:]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>aa</th>
      <th>formula</th>
      <th>mass</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>65</th>
      <td>A</td>
      <td>C(3)H(5)N(1)O(1)S(0)</td>
      <td>7.103711e+01</td>
    </tr>
    <tr>
      <th>66</th>
      <td>B</td>
      <td>C(1000000)</td>
      <td>1.200000e+07</td>
    </tr>
    <tr>
      <th>67</th>
      <td>C</td>
      <td>C(3)H(5)N(1)O(1)S(1)</td>
      <td>1.030092e+02</td>
    </tr>
    <tr>
      <th>68</th>
      <td>D</td>
      <td>C(4)H(5)N(1)O(3)S(0)</td>
      <td>1.150269e+02</td>
    </tr>
    <tr>
      <th>69</th>
      <td>E</td>
      <td>C(5)H(7)N(1)O(3)S(0)</td>
      <td>1.290426e+02</td>
    </tr>
    <tr>
      <th>70</th>
      <td>F</td>
      <td>C(9)H(9)N(1)O(1)S(0)</td>
      <td>1.470684e+02</td>
    </tr>
    <tr>
      <th>71</th>
      <td>G</td>
      <td>C(2)H(3)N(1)O(1)S(0)</td>
      <td>5.702146e+01</td>
    </tr>
    <tr>
      <th>72</th>
      <td>H</td>
      <td>C(6)H(7)N(3)O(1)S(0)</td>
      <td>1.370589e+02</td>
    </tr>
    <tr>
      <th>73</th>
      <td>I</td>
      <td>C(6)H(11)N(1)O(1)S(0)</td>
      <td>1.130841e+02</td>
    </tr>
    <tr>
      <th>74</th>
      <td>J</td>
      <td>C(6)H(11)N(1)O(1)S(0)</td>
      <td>1.130841e+02</td>
    </tr>
    <tr>
      <th>75</th>
      <td>K</td>
      <td>C(6)H(12)N(2)O(1)S(0)</td>
      <td>1.280950e+02</td>
    </tr>
    <tr>
      <th>76</th>
      <td>L</td>
      <td>C(6)H(11)N(1)O(1)S(0)</td>
      <td>1.130841e+02</td>
    </tr>
    <tr>
      <th>77</th>
      <td>M</td>
      <td>C(5)H(9)N(1)O(1)S(1)</td>
      <td>1.310405e+02</td>
    </tr>
    <tr>
      <th>78</th>
      <td>N</td>
      <td>C(4)H(6)N(2)O(2)S(0)</td>
      <td>1.140429e+02</td>
    </tr>
    <tr>
      <th>79</th>
      <td>O</td>
      <td>C(12)H(19)N(3)O(2)</td>
      <td>2.371477e+02</td>
    </tr>
    <tr>
      <th>80</th>
      <td>P</td>
      <td>C(5)H(7)N(1)O(1)S(0)</td>
      <td>9.705276e+01</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Q</td>
      <td>C(5)H(8)N(2)O(2)S(0)</td>
      <td>1.280586e+02</td>
    </tr>
    <tr>
      <th>82</th>
      <td>R</td>
      <td>C(6)H(12)N(4)O(1)S(0)</td>
      <td>1.561011e+02</td>
    </tr>
    <tr>
      <th>83</th>
      <td>S</td>
      <td>C(3)H(5)N(1)O(2)S(0)</td>
      <td>8.703203e+01</td>
    </tr>
    <tr>
      <th>84</th>
      <td>T</td>
      <td>C(4)H(7)N(1)O(2)S(0)</td>
      <td>1.010477e+02</td>
    </tr>
    <tr>
      <th>85</th>
      <td>U</td>
      <td>C(3)H(5)N(1)O(1)Se(1)</td>
      <td>1.509536e+02</td>
    </tr>
    <tr>
      <th>86</th>
      <td>V</td>
      <td>C(5)H(9)N(1)O(1)S(0)</td>
      <td>9.906841e+01</td>
    </tr>
    <tr>
      <th>87</th>
      <td>W</td>
      <td>C(11)H(10)N(2)O(1)S(0)</td>
      <td>1.860793e+02</td>
    </tr>
    <tr>
      <th>88</th>
      <td>X</td>
      <td>C(1000000)</td>
      <td>1.200000e+07</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Y</td>
      <td>C(9)H(9)N(1)O(2)S(0)</td>
      <td>1.630633e+02</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Z</td>
      <td>C(1000000)</td>
      <td>1.200000e+07</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="calc_sequence_mass-can-easily-get-the-mass-list-of-each-amino-acid."><a href="/alphabase/aa.html#calc_sequence_mass"><code>calc_sequence_mass</code></a> can easily get the mass list of each amino acid.<a class="anchor-link" href="#calc_sequence_mass-can-easily-get-the-mass-list-of-each-amino-acid."> </a></h3><p>The key is: <code>np.array(sequence, 'c').view(np.int8)</code> converts a string into an ASCII code array</p>
<p>Note that this function is rarely used in alphabase as it is not fast for a set of peptides.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="calc_sequence_mass" class="doc_header"><code>calc_sequence_mass</code><a href="https://github.com/MannLabs/alphabase/tree/main/alphabase/constants/aa.py#L66" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>calc_sequence_mass</code>(<strong><code>sequence</code></strong>:<code>str</code>)</p>
</blockquote>
<p>Args:
    sequence (str): unmodified peptide sequence
Returns:
    np.array: masses of each amino acid.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We provide <code>calc_AA_masses_for_same_len_seqs()</code> and <code>calc_sequence_masses_for_same_len_seqs()</code> functions to fast calculate masses for a given array of AA sequences with same length. They are fast because they both use <code>slicing</code> and <code>reshape</code> operation based on <a href="/alphabase/aa.html#AA_ASCII_MASS"><code>AA_ASCII_MASS</code></a> array.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="calc_AA_masses_for_same_len_seqs" class="doc_header"><code>calc_AA_masses_for_same_len_seqs</code><a href="https://github.com/MannLabs/alphabase/tree/main/alphabase/constants/aa.py#L78" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>calc_AA_masses_for_same_len_seqs</code>(<strong><code>sequence_array</code></strong>:<code>array</code>)</p>
</blockquote>
<p>Calculate AA masses for the array of same-len AA sequences.</p>
<p>Args:
    sequence_array (np.array): unmodified sequences with the same length.</p>
<p>Returns:
    np.array: 2-D (array_size, sequence_len) array of masses.</p>
<p>Raises:
    ValueError: if sequences are not with the same length.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="calc_sequence_masses_for_same_len_seqs" class="doc_header"><code>calc_sequence_masses_for_same_len_seqs</code><a href="https://github.com/MannLabs/alphabase/tree/main/alphabase/constants/aa.py#L99" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>calc_sequence_masses_for_same_len_seqs</code>(<strong><code>sequence_array</code></strong>:<code>array</code>)</p>
</blockquote>
<p>Calculate sequence masses for the array of same-len AA sequences.</p>
<p>Args:
    sequence_array (np.array): unmodified sequences with the same length.</p>
<p>Returns:
    np.array: 1-D (array_size, sequence_len) array of masses.</p>
<p>Raises:
    ValueError: if sequences are not with the same length.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="For-a-single-sequence">For a single sequence<a class="anchor-link" href="#For-a-single-sequence"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
    <span class="n">calc_sequence_mass</span><span class="p">(</span><span class="s1">&#39;ACDEFGNYK&#39;</span><span class="p">),</span>
    <span class="p">[</span> <span class="mf">71.03711379</span><span class="p">,</span> <span class="mf">103.00918496</span><span class="p">,</span> <span class="mf">115.02694302</span><span class="p">,</span> <span class="mf">129.04259309</span><span class="p">,</span>
       <span class="mf">147.06841391</span><span class="p">,</span>  <span class="mf">57.02146372</span><span class="p">,</span> <span class="mf">114.04292744</span><span class="p">,</span> <span class="mf">163.06332853</span><span class="p">,</span>
       <span class="mf">128.09496302</span> <span class="p">]</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="For-sequences-with-the-same-length">For sequences with the same length<a class="anchor-link" href="#For-sequences-with-the-same-length"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="It-is-very-easy-to-generate-b/y-ions-from-a-sequence-or-a-list-of-sequences-with-same-length">It is very easy to generate b/y ions from a sequence or a list of sequences with same length<a class="anchor-link" href="#It-is-very-easy-to-generate-b/y-ions-from-a-sequence-or-a-list-of-sequences-with-same-length"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">aa_masses</span> <span class="o">=</span> <span class="n">calc_AA_masses_for_same_len_seqs</span><span class="p">([</span><span class="s1">&#39;ACDEFGHIK&#39;</span><span class="p">,</span><span class="s1">&#39;BCDEFGHIK&#39;</span><span class="p">,</span><span class="s1">&#39;CCDEFGHIK&#39;</span><span class="p">])</span>
<span class="n">b_masses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">aa_masses</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">b_masses</span><span class="p">,</span> <span class="n">pepmass</span> <span class="o">=</span> <span class="n">b_masses</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">b_masses</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">pepmass</span> <span class="o">+=</span> <span class="n">MASS_H2O</span>
<span class="p">{</span><span class="s1">&#39;pepmass&#39;</span><span class="p">:</span><span class="n">pepmass</span><span class="p">,</span> <span class="s1">&#39;b masses&#39;</span><span class="p">:</span><span class="n">b_masses</span><span class="p">,</span> <span class="s1">&#39;y masses&#39;</span><span class="p">:</span><span class="n">pepmass</span><span class="o">-</span><span class="n">b_masses</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;pepmass&#39;: array([[1.01845422e+03],
        [1.20009474e+07],
        [1.05042629e+03]]),
 &#39;b masses&#39;: array([[7.10371138e+01, 1.74046299e+02, 2.89073242e+02, 4.18115835e+02,
         5.65184249e+02, 6.22205712e+02, 7.59264624e+02, 8.72348688e+02],
        [1.20000000e+07, 1.20001030e+07, 1.20002180e+07, 1.20003471e+07,
         1.20004941e+07, 1.20005512e+07, 1.20006882e+07, 1.20008013e+07],
        [1.03009185e+02, 2.06018370e+02, 3.21045313e+02, 4.50087906e+02,
         5.97156320e+02, 6.54177784e+02, 7.91236696e+02, 9.04320760e+02]]),
 &#39;y masses&#39;: array([[947.41710224, 844.40791728, 729.38097426, 600.33838117,
         453.26996726, 396.24850354, 259.18959168, 146.1055277 ],
        [947.41710224, 844.40791728, 729.38097426, 600.33838117,
         453.26996726, 396.24850354, 259.18959168, 146.1055277 ],
        [947.41710224, 844.40791728, 729.38097426, 600.33838117,
         453.26996726, 396.24850354, 259.18959168, 146.1055277 ]])}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/alphabase/aa.html#calc_AA_masses_for_var_len_seqs"><code>calc_AA_masses_for_var_len_seqs</code></a> is rarely used in alphabase.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="calc_AA_masses_for_var_len_seqs" class="doc_header"><code>calc_AA_masses_for_var_len_seqs</code><a href="https://github.com/MannLabs/alphabase/tree/main/alphabase/constants/aa.py#L121" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>calc_AA_masses_for_var_len_seqs</code>(<strong><code>sequence_array</code></strong>:<code>array</code>)</p>
</blockquote>
<p>We recommend to use <a href="/alphabase/aa.html#calc_AA_masses_for_same_len_seqs"><code>calc_AA_masses_for_same_len_seqs</code></a> as it is much faster.</p>
<p>Args:
    sequence_array (np.array): sequences with variable lengths.</p>
<p>Returns:
    np.array: 1D array of masses, zero values are padded to fill the max length.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">masses</span> <span class="o">=</span> <span class="n">calc_AA_masses_for_var_len_seqs</span><span class="p">([</span><span class="s1">&#39;EFGHIK&#39;</span><span class="p">,</span><span class="s1">&#39;AAAGCDEFGHIK&#39;</span><span class="p">,</span><span class="s1">&#39;DDDDCCDEFGHIK&#39;</span><span class="p">])</span>
<span class="n">masses</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[1.29042593e+02, 1.47068414e+02, 5.70214637e+01, 1.37058912e+02,
        1.13084064e+02, 1.28094963e+02, 1.00000000e+08, 1.00000000e+08,
        1.00000000e+08, 1.00000000e+08, 1.00000000e+08, 1.00000000e+08,
        1.00000000e+08],
       [7.10371138e+01, 7.10371138e+01, 7.10371138e+01, 5.70214637e+01,
        1.03009185e+02, 1.15026943e+02, 1.29042593e+02, 1.47068414e+02,
        5.70214637e+01, 1.37058912e+02, 1.13084064e+02, 1.28094963e+02,
        1.00000000e+08],
       [1.15026943e+02, 1.15026943e+02, 1.15026943e+02, 1.15026943e+02,
        1.03009185e+02, 1.03009185e+02, 1.15026943e+02, 1.29042593e+02,
        1.47068414e+02, 5.70214637e+01, 1.37058912e+02, 1.13084064e+02,
        1.28094963e+02]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

